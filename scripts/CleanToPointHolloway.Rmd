---
title: "Holloway Clean to Point"
author: "Anna Talucci"
date: "2023-07-13"
output: html_document
---



# clear environment
```{r}
rm(list=ls())
```

# Overview

Adapt script form M. Loranty data_cleaning, to only clean and not aggregate data. 

Use data from csv files in Google Drive

What this script does:


# Packages

```{r}
library(tidyverse)
library(lubridate)
library(sf)

```
# Projection

WGS 84 need for gee
```{r}
wgs_proj =  "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs "
```

# Data

# vector of data files
```{r}
f <- list.files(path = "../data/GoogleDriveCsvFolder/",
                pattern = "*.csv", full.names = TRUE)
```

```{r}
f
```



## Holloway
```{r}
f8 <- read.csv(f[8], header = TRUE) 
```



# View data
```{r}
glimpse(f8)
```
# check thaw_active and slope
```{r}
unique(f8$thaw_active)
unique(f8$slope)
```
# Check gt_probe yes
```{r}
gtProbeYes = filter(f8, gt_probe=="y")
unique(gtProbeYes$thaw_depth)
```


# Fixes 
```{r}
f8 = f8 %>%
     mutate(thaw_active=replace(thaw_active, thaw_active==TRUE, 'thaw')) %>% # switch true to thaw
     as.data.frame() %>%
  mutate(slope=replace(slope, slope==FALSE, 'flat')) %>% # switch false to flat
     as.data.frame() %>%
  mutate(gt_probe=replace(gt_probe, thaw_depth==87, "n")) %>%
     as.data.frame() %>%
  mutate(gt_probe=replace(gt_probe, thaw_depth %in% c("110+", "125+", "120+", "180+", "195+"), "y")) %>%
     as.data.frame() %>%
  mutate(thaw_depth = gsub("\\+","", thaw_depth)) %>%
  mutate(thaw_depth = as.numeric(thaw_depth))
```


```{r}
f8
```

# examine unique combinations of identify information for aggregatation
```{r}
f8 %>% distinct(site_id,year,month,day,fire_id,burn_unburn)
```

```{r}
str(f8)
```

```{r}
f8_dates = f8 %>%
  mutate(date = as.Date(with(., paste(year, month, day,sep="-")), "%Y-%m-%d")) %>%
  mutate(julianDate = yday(date)) 

f8_dates
```


```{r}
f8_dates %>% distinct(site_id, plot_id, fire_id, burn_unburn) %>% write.csv(., '../outputs/pairs/holloway.csv')
```



```{r}
f8_dates %>% distinct(julianDate, year, date)
```



# Create points shapefile

```{r}
f8_pts = st_as_sf(f8_dates, coords = c("long","lat"), crs = 4326, remove = FALSE)
```


# write to shapefile
```{r eval=FALSE, include=FALSE}
st_write(f8_pts, "../outputs/allPoints/Holloway_pts.shp", driver="ESRI Shapefile")
```