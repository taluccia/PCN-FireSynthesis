---
title: "Explore Air Temp data"
author: "Anna Talucci"
date: '2023-01-26'
output: html_document
---

# Overview

# Packages
```{r}
library(tidyverse)
library(lubridate)
```

# Graph theme
```{r}

reg_theme = theme_bw() + theme(legend.position = "none") +
  theme(plot.margin = unit(c(t = 0.3, r = 0.3, b = 0.3, l = 0.1), "cm")) +
  theme(axis.title.x = element_text(size = 11, hjust = 0.5, vjust = -0.1),
        axis.title.y = element_text(size = 11, hjust = 0.5, vjust = 1.1),
        axis.text.x = element_text(size = 10, color = "black"),
        axis.text.y = element_text(size = 10, color = "black"),
        panel.background = element_blank(),
        axis.line = element_line(colour = "black"))

```

# Data
```{r}
manies = read.csv("../data/ERA5forThawPoints/ERA5DailyMeanT2M_ManiesSept30.csv")
natali2017 = read.csv("../data/ERA5forThawPoints/2017ERA5DailyMeanT2M_NataliSept30.csv")
natali2016 = read.csv("../data/ERA5forThawPoints/2016ERA5DailyMeanT2M_NataliSept30.csv")
odonnell2005 = read.csv("../data/ERA5forThawPoints/2005ERA5DailyMeanT2M_ODonnellSept30.csv")
olefeldt2015 = read.csv("../data/ERA5forThawPoints/2015ERA5DailyMeanT2M_OlefeldtSept30.csv")
olefeldt2016 = read.csv("../data/ERA5forThawPoints/2016ERA5DailyMeanT2M_OlefeldtSept30.csv")
olefeldt2020 = read.csv("../data/ERA5forThawPoints/2020ERA5DailyMeanT2M_OlefeldtSept30.csv")
Rocha2008 = read.csv("../data/ERA5forThawPoints/2008ERA5DailyMeanT2M_RochaSept30.csv")
Rocha2009 = read.csv("../data/ERA5forThawPoints/2009ERA5DailyMeanT2M_RochaSept30.csv")
Rocha2010 = read.csv("../data/ERA5forThawPoints/2010ERA5DailyMeanT2M_RochaSept30.csv")
Rocha2011 = read.csv("../data/ERA5forThawPoints/2011ERA5DailyMeanT2M_RochaSept30.csv")
Rocha2012 = read.csv("../data/ERA5forThawPoints/2012ERA5DailyMeanT2M_RochaSept30.csv")
Rocha2013 = read.csv("../data/ERA5forThawPoints/2013ERA5DailyMeanT2M_RochaSept30.csv")
Rocha2014 = read.csv("../data/ERA5forThawPoints/2014ERA5DailyMeanT2M_RochaSept30.csv")
Rocha2015 = read.csv("../data/ERA5forThawPoints/2015ERA5DailyMeanT2M_RochaSept30.csv")
Rocha2016 = read.csv("../data/ERA5forThawPoints/2016ERA5DailyMeanT2M_RochaSept30.csv")
Rocha2017 = read.csv("../data/ERA5forThawPoints/2017ERA5DailyMeanT2M_RochaSept30.csv")
Rocha2018 = read.csv("../data/ERA5forThawPoints/2018ERA5DailyMeanT2M_RochaSept30.csv")
Rocha2019 = read.csv("../data/ERA5forThawPoints/2019ERA5DailyMeanT2M_RochaSept30.csv")
Rocha2020 = read.csv("../data/ERA5forThawPoints/2020ERA5DailyMeanT2M_RochaSept30.csv")
```

# Look at data
```{r}
head(manies)
```
# Organize and Clean

## Select, Pivot Air Temp data
```{r}
manies1 = manies %>%
  dplyr::select(brl_tnd:year, X20010401_mean_2m_air_temperature:X20010930_mean_2m_air_temperature) %>%
  pivot_longer(
    cols = starts_with("X"),
    names_to = "DateTemp",
    values_to = "TempC",
    values_drop_na = TRUE) %>% 
  separate(DateTemp, c("tempDate", NA)) %>% 
    mutate(across(tempDate, ~ . |> str_extract("\\d+") |> as.character())) 
```
## Format air temp date
```{r}
manies1$tempDate = ymd(manies1$tempDate)
```

## Add Julian day for air temp
```{r}
manies2 = manies1 %>% mutate(tempJuldt = yday(tempDate))
```

```{r}
manies2
```


# Plot Temp data by day

## Manies
243 267 215 266 218
```{r}
ggplot(manies2, aes(x=tempJuldt, y=TempC, color=site_id)) +
  geom_line() +
  geom_vline(xintercept=215) + # Aug 3
  geom_vline(xintercept=218) + # Aug 6
  geom_vline(xintercept=243) + # Aug 31
  geom_vline(xintercept=266) + # Sept 23
  geom_vline(xintercept=267) + #Sept 24
  reg_theme +
  xlab("Julian date") +
  ylab("Temperature in degrees Celecius") +
  geom_text(aes(x=215, label="Aug 3", y=-5), colour="grey", angle=90, vjust = -0.5, text=element_text(size=8)) +
  geom_text(aes(x=243, label="Aug 31", y=-5), colour="grey", angle=90, vjust = -0.5, text=element_text(size=8)) +
  geom_text(aes(x=266, label="Sept 23", y=-5), colour="grey", angle=90, vjust = -0.5, text=element_text(size=8))
```